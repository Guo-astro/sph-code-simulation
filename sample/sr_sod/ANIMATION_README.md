# SR-GSPH Sod Shock Tube Animation

## Overview
This directory contains scripts and results for the Special Relativistic Godunov SPH (SR-GSPH) implementation of the Sod shock tube test.

## Generated Animations

### 1. Basic Animation (`sr_profiles_animation.gif` - 231 KB)
- 4 panels: Density, Velocity, Pressure, Internal Energy
- Generated by: `plot_sr_profiles.py`
- Basic visualization of shock tube evolution

### 2. Enhanced Animation (`sr_sod_enhanced.gif` - 511 KB)
- 6 panels including:
  - Rest-frame density ρ
  - Velocity v/c
  - Pressure P (log scale)
  - Internal Energy u
  - Lorentz factor Γ
  - Phase diagram (P vs ρ)
- Generated by: `create_sr_animation.py`
- Higher quality with fixed axes ranges for better comparison

## Usage

### Generate Basic Animation
```bash
python3 sample/sr_sod/scripts/plot_sr_profiles.py sample/sr_sod/results
```

### Generate Enhanced Animation
```bash
python3 sample/sr_sod/scripts/create_sr_animation.py sample/sr_sod/results sr_sod_enhanced gif 8
```

Arguments:
- `results_directory`: Path to results folder with snapshot CSV files
- `output_name`: Base filename (without extension)
- `format`: 'gif' or 'mp4' (requires FFmpeg)
- `fps`: Frames per second (default: 10)

## Simulation Details

**Method**: SR-GSPH (Special Relativistic Godunov SPH) 2nd order
- Volume-based approach for baryon number density (Eq. 42 from Kitajima et al. 2025)
- Iterative smoothing length with corrected η parameter
- MUSCL reconstruction for 2nd order accuracy

**Initial Conditions** (SR Sod shock tube):
- Left state:  P=1.0, ρ=1.0, v=0, 3200 particles
- Right state: P=0.1, ρ=0.125, v=0, 400 particles
- Domain: x ∈ [-0.5, 0.5]
- Discontinuity at x=0

**Parameters**:
- Speed of light: c = 1
- Adiabatic index: γ = 5/3
- Neighbor number: 50
- CFL (sound): 0.5
- Kernel: Cubic Spline

**Key Fix Applied**:
The smoothing length iteration formula `h = η × Vp*^(1/d)` was corrected by setting:
```cpp
η = neighbor_number / (2.0 × A) = 50 / 4 = 12.5
```
This ensures h maintains the correct scale (~25 particle spacings in 1D) rather than collapsing to single particle spacing.

## Results

- **Total snapshots**: 20 (at t = 0.00, 0.01, 0.02, ..., 0.19)
- **Simulation progress**: t ≈ 0.19 / 0.35 (54% complete)
- **Timestep**: dt ≈ 7-8 × 10⁻⁴ (stable)
- **Smoothing length**: h ≈ 0.002-0.004 (stable, no collapse)

## Files Generated

```
sample/sr_sod/results/
├── snapshot_0000.csv to snapshot_0019.csv  # Particle data at each output
├── energy.dat                               # Energy conservation tracking
├── sr_profiles_animation.gif               # Basic 4-panel animation
├── sr_sod_enhanced.gif                     # Enhanced 6-panel animation
└── sr_profiles_profiles.png                # Static comparison plot
```

## References

- Kitajima, T., Inutsuka, S., & Seno, H. (2025). "A New Formulation of Smoothed Particle Hydrodynamics with Good Conservation Properties and Improved Accuracy for Strong Shocks". arXiv:2510.18251v1
