# 1D Strong Shock Test

## Overview

This test simulates an extreme pressure discontinuity with a pressure ratio of **10,000:1**, designed to test the SPH method's ability to handle strong shocks without oscillations or numerical instabilities.

**Test Configuration:**
- **Left state**: ρ = 1.0, P = 1000.0, v = 0
- **Right state**: ρ = 1.0, P = 0.1, v = 0
- **Pressure ratio**: P_left/P_right = 10,000
- **Domain**: [-0.5, 0.5] with discontinuity at x = 0
- **Adiabatic index**: γ = 1.4

**Note**: The domain `[-0.5, 0.5]` is defined in `src/sample/strong_shock.cpp` as the **Single Source of Truth (SSOT)**. All configuration files and visualization scripts are synchronized to this domain.

## Physical Behavior

This extreme pressure discontinuity creates a **very strong shock wave** propagating into the low-pressure region. The test challenges:

1. **Numerical stability** in the presence of extreme gradients
2. **Shock capturing** without artificial oscillations
3. **Energy conservation** across the shock front
4. **Pressure evolution** accuracy

## Quick Start

### Run Everything (One-Shot)
```bash
make strong_shock_all
```
This runs all 5 SPH methods, generates comparison plots and animations.

### Run Single Method
```bash
make strong_shock_run              # Default: GSPH + Cubic Spline
make strong_shock_gsph_cubic       # GSPH specifically
```

### Multi-Method Comparison
```bash
make strong_shock_compare_all      # Run all 5 methods + visualizations
make strong_shock_compare_run      # Just run simulations
make strong_shock_compare_viz      # Just generate plots
make strong_shock_compare_animate  # Just create animations
```

## Available Targets

Run `make strong_shock_help` for complete list.

### Complete Workflow
- `strong_shock_all` - Run EVERYTHING (all methods, plots, animations)

### Single Method Runs
- `strong_shock_run` - Default (GSPH + Cubic Spline)
- `strong_shock_gsph_cubic` - GSPH method
- `strong_shock_ssph_cubic` - SSPH method
- `strong_shock_disph_cubic` - DISPH method
- `strong_shock_gdisph_cubic` - GDISPH method
- `strong_shock_balsara_cubic` - GDISPH with Balsara switch

### Multi-Method Comparison
- `strong_shock_compare_all` - Complete comparison workflow
- `strong_shock_compare_run` - Run all 5 methods
- `strong_shock_compare_viz` - Generate comparison plots
- `strong_shock_compare_animate` - Create animations
- `strong_shock_compare_clean` - Clean comparison results

### Cleanup
- `strong_shock_clean` - Remove all results

## Methods Tested

1. **GSPH** - Godunov SPH with 2nd-order MUSCL reconstruction
2. **SSPH** - Standard SPH
3. **DISPH** - Density-Independent SPH
4. **GDISPH** - Godunov DISPH with 2nd-order reconstruction
5. **GDISPH+Balsara** - GDISPH with Balsara viscosity limiter

## Expected Results

For this extreme shock test:
- **Strong shock** forms and propagates right
- **Contact discontinuity** develops
- **Expansion wave** propagates left
- Numerical methods should **not oscillate** (post-shock wiggles)
- **Energy conservation** should be maintained

Methods with **Godunov Riemann solvers** (GSPH, GDISPH) should show:
- Sharper shock fronts
- Less numerical diffusion
- Better energy conservation

## Kernel Support

**Note**: This is a **1D test** and only supports the **Cubic Spline kernel**.
- Wendland C4 kernel is **not supported in 1D**
- All presets use `cubic_spline` kernel

## Output

Results are saved in:
```
sample/strong_shock/results/
├── gsph_cubic/
│   ├── plots_analytical/      # Exact Riemann solution overlays
│   └── *.csv snapshots
├── ssph_cubic/
│   ├── plots_analytical/
│   └── *.csv snapshots
├── disph_cubic/
│   ├── plots_analytical/
│   └── *.csv snapshots
├── gdisph_cubic/
│   ├── plots_analytical/
│   └── *.csv snapshots
├── gdisph_balsara_cubic/
│   ├── plots_analytical/
│   └── *.csv snapshots
├── comparison/          # Multi-method comparison plots
└── animations/          # GIF animations
```

### Analytical Solution Overlays

Each method directory contains `plots_analytical/` with SPH vs. exact Riemann solution comparisons:
- Density, velocity, pressure, and internal energy plots
- Exact solution computed using Newton-Raphson iteration
- Automatically generated by `make strong_shock_compare_viz`
- 25 snapshots per method (125 total plots)

## Configuration Files

Preset configurations are in:
```
sample/strong_shock/config/presets/
├── strong_shock_gsph_cubic.json
├── strong_shock_ssph_cubic.json
├── strong_shock_disph_cubic.json
├── strong_shock_gdisph_cubic.json
└── strong_shock_gdisph_balsara_cubic.json
```

## Key Parameters

All presets use:
- **Particles**: N = 800
- **End time**: 0.012
- **Output interval**: 0.0005
- **Domain**: [-0.5, 0.5] (non-periodic)
- **Neighbor number**: 5.2
- **Artificial viscosity**: α = 1.0

## Reference

Based on Hopkins (2015) DISPH paper, Section 4.2 - Strong Shock Test
